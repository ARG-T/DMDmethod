import numpy as np


def ret_spline(inp, matrix, x_data):
    """
    引数xが該当する区間を見つけてきて補間後の値を返す
    """
    xlen = len(x_data)
    for index, j in enumerate(x_data):
        if inp < j:
            index -= 1
            break
    if index == -1:
        index += 1
    elif index == xlen-1:
        index -= 1
    a3 = matrix[4*index + 3]
    a2 = matrix[4*index + 2]
    a1 = matrix[4*index + 1]
    a0 = matrix[4*index + 0]

    result = a3*pow(inp, 3) + a2*pow(inp, 2) + a1*inp + a0
    return result


phy_X = np.array([1.453676923, 1.742692837, 2.055801767, 2.368910698, 2.682019628, 2.995128558, 3.308237488, 3.621346419, 3.934455349, 4.247564279, 4.560673209, 4.87378214, 5.18689107, 5.5, 5.81310893])
phy_y = np.array([9.524761538, 3.7443, 0.9108, 0.3881, -0.0188, -0.2481, -0.2645, -0.2272, -0.1293, -0.0597, -0.0311, -0.0139, -0.0032, 0, 0])
phy_matrix = np.array([38.5983, -20.0, 0, 0, 169.95555434400455, -213.44197914615506, 89.58345040371069, -12.529090379665263, 199.20014906373552, -256.1181678563256, 110.34235303489521, -15.894995751219007, -73.39680776884938, 89.09994069803741, -35.3862760965532, 4.61072012548934, 25.91812708186535, -21.9897774537736, 6.033897339929553, -0.537163333187415, 46.79316391612184, -42.89876659732725, 13.014896231514903, -1.314091463471847, -22.791648844343896, 20.202639827880944, -6.059129334695655, 0.6077803928058952, 48.40614576665696, -38.7791197498135, 10.228116554909622, -0.8914083991630706, -9.635387703698385, 5.477221971111746, -1.0202870474272707, 0.0615742972598583, -22.580876257094303, 14.620453976380077, -3.1728694228071106, 0.23050110126548673, 0.8376640901575598, -0.7842062178897962, 0.20484686782086747, -0.016371537622006826, 0.2298565476486587, -0.4100773431989495, 0.12808330639281618, -0.011121435529969081, -6.033056686330198, 3.212273588866527, -0.5702831877517189, 0.03375878814157052, 0, 0, 0, 0])


rho_X = np.array([1.82038, 2.0558, 2.29122, 2.52664, 2.76206, 2.99748, 3.2329, 3.46832, 3.70374, 3.93916, 4.17458, 4.41, 4.64542])
rho_y = np.array([1.98292, 1.7475, -5.8678, -8.3376, -5.8399, -3.1141, -1.7257, -0.4429, -0.1467, -0.2096, -0.1442, 0, 0])
rho_matrix = np.array([3.8033, -1, 0, 0, -3064.23873, 4263.58898, -1961.70616, 298.2907, 1250.22297, -1385.53467, 503.846541, -60.4050606, 1410.03373, -1575.2856, 578.946644, -70.3128305, 383.220459, -460.016625, 175.165055, -21.5833088, -1185.44742, 1109.97005, -348.603801, 36.662157, 1089.20826, -1000.81812, 304.304784, -30.6570286, -959.343518, 771.121998, -206.588131, 18.4438728, -275.020362, 216.825673, -56.9295901, 4.97473614, 89.3986807, -60.7099251, 13.5259381, -0.98723953, 368.205196, -261.070092, 61.5212256, -4.81958414, 0, 0, 0, 0])

f_X = np.array([1.794222222, 2.0558, 2.317377778, 2.578955556, 2.840533333, 3.102111111, 3.363688889, 3.625266667, 3.886844444, 4.148422222, 4.41, 4.671577778])
f_y = np.array([-0.873933651, -0.1485, 1.6845, 2.0113, 1.1444, 0.2862, -0.3459, -0.6258, -0.612, -0.3112, 0, 0])
f_matrix = np.array([-5.84985, 2.7733, 0, 0, 448.74591441, -632.01326202, 293.44604076, -44.86373342, -259.76560021, 285.20211997, -102.35277577, 12.06826105, -293.77175671, 324.76017643, -117.6915653, 14.05081939, 53.25633892, -41.74996968, 11.33707233, -1.09054346, -52.67497511, 60.69444019, -21.68702197, 2.45801784, 105.41979458, -80.30680122, 20.23161143, -1.6960161, -25.77273211, 28.2583379, -9.71518948, 1.05751017, 207.10664981, -151.48596518, 36.52908545, -2.90836975, 347.74667126, -253.19211796, 61.04591314, -4.87834181, 0, 0, 0, 0])

U_X = np.array([-65.54363333, -55.1423, -44.74096667, -34.33963333, -23.9383, -13.53696667])
U_y = np.array([-0.3785904, -0.29746, -0.15449, 0.05099, 0.57343, 1.667650267])
U_matrix = np.array([0.13265, 0.0078, 0, 0, -0.67329036, -0.0655428591, -0.00181122337, -1.35324663e-05, 4.21319602, 0.26210896, 0.0055120833, 4.10283178e-05, 5.61059238, 0.384189154, 0.00906716476, 7.55373395e-05, 3.09174, 0.1052, 0, 0])

g_X = np.array([-1.275485714, -1, -0.724514286, -0.449028571, -0.173542857, 0.101942857, 0.377428571, 0.652914286, 0.9284, 1.203885714])
g_y = np.array([-2.220059109, 0.0765, 0.1416, 0.7579, 0.6301, 0.0905, -0.3574, -0.6529, -6.0091, -22.64912586])
g_matrix = np.array([8.4096, 8.3364, 0, 0, 26.6850027, 98.2759409, 120.345034, 48.677596, -3.43990851, -26.4624328, -51.8232392, -30.5332982, 0.365719628, -1.03669115, 4.80064454, 11.5010603, 0.307819187, -2.03760428, -0.966882564, 0.423052969, 0.296731016, -1.7112988, -4.16774905, 10.8892644, 3.09071723, -23.9193648, 54.6726985, -41.0768135, 18.3571745, -94.0654358, 162.108043, -95.9259447, 50.06858, -60.4025, 0, 0])
